!function(a,b){"use strict";var c=window.GEM||{};c.DEBUG_FLAG=!0,c.init=function(){a("form.gem-form").submit(function(b){b.preventDefault();var d="",e=0,f="";a(this).find(":input").each(function(b){var c="",c=a(this).attr("name");"checkbox"==a(this).attr("type")&&a(this).is(":checked")&&(f!=c&&(f=c,e=0),0==e&&(d=a("input:checkbox[name='"+c+"']:checked").map(function(){return this.value}).get().join(", "),e=1),a("input[name='"+c+"']").val(d))});var g="",h="",i=[];a(this).find("[fingerprint='date']").each(function(b){var c="",c=a(this).attr("name");"date"==a(this).attr("fingerprint")&&(h!=c&&(h=c,i=[],g=""),i.push(a(this).val()),3==i.length&&(g=i[0]+" "+i[1]+", "+i[2]),a("input[name='"+c+"']").val(g))});var j=a(this),k=a(".gem-spinner",j),l=a(this).serialize(),m=[],n=c;if(j.find("input.gem-invalid").removeClass("gem-invalid"),a(this).find(":input").each(function(b){"signup[email]"!=a(this).attr("name")||c.isEmail(a(this).val())?a(this).is(".gem-required")&&""==a(this).val()&&(m.push(a(this)),n.log("A required filled was not filled")):(m.push(a(this)),n.log("Email is NOT valid"))}),0==m.length)k.css("display","inline-block"),a.post(j.attr("action")+".json",l,function(a){j.fadeOut("fast",function(){if(a.success){var b=a.result,d=b.audience_member.suppressed;b.has_redirect&&(window.location.href=b.redirect),j.html(c.addMessage(d?["suppressed","success"]:["info","success"],d?c.thankyou_suppressed:c.thankyou)).fadeIn("fast")}else j.html(c.addMessage("info",c.oops)).fadeIn("fast")})},"jsonp");else{a(m).each(function(b,c){a(this).addClass("gem-invalid")});var o=j.find(".gem-error, .gem-info");0!=o.length&&o.remove(),j.prepend(c.addMessage("error",c.fix))}})},c.addMessage=function(b,c){var d=[];return a.isArray(b)?a.each(b,function(a,b){d.push("gem-"+b)}):d.push("gem-"+b.toString()),a("<p/>",{"class":d.join(" ")}).text(c)},c.isEmail=function(a){var b=/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;return b.test(a)},c.log=function(a){c.DEBUG_FLAG&&window.console&&console.log(a)},a.fn.gemSerializeObject=function(){var b={},c=this.serializeArray();return a.each(c,function(){b[this.name]?(b[this.name].push||(b[this.name]=[b[this.name]]),b[this.name].push(this.value||"")):b[this.name]=this.value||""}),b},a(document).ready(c.init)}(jQuery);